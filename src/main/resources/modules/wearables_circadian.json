{
  "name": "Wearables_Sleep",
  "remarks": [
    "Wearable devices are routinely used for fitness activities, compliance monitoring, and remote patient monitoring workflows (such as post-surgical stepdown).  This module simulates the use of an iWatch werable, and adds FHIR Observation resources corresponding to common biomarkers tracked by the iWatch (step count, step distance, flights climbed, standing time, etc).",
    "It uses the Pew Research Center data estimating 20% of the population wears a smartwatch.  With mortality effects and demographic age brackets, this works out to approximately 10% of the Synthea patient's generated having wearables data.",
    "If you wish to include granular SleepMonitor data and media files, enable the `physiology.state.enabled` and `physiology.generators.enabled` fields to true in the `synthea.properties` file.",
    "",
    "References",
    "Smartwatch Statistics 2023: How Many People Use Smartwatches?",
    "https://www.demandsage.com/smartwatch-statistics/#:~:text=45%25%20of%20Americans%20regularly%20wear%20smartwatches.",
    "",
    "About one-in-five Americans use a smart watch or fitness tracker",
    "https://www.pewresearch.org/short-reads/2020/01/09/about-one-in-five-americans-use-a-smart-watch-or-fitness-tracker/",
    "", 
    "Known model limitations:",
    "- This module is Apple centric, and may not model biomarkers found in Garmin devices, Fitbits, and other wearables (yet).",
    "- Most biomarkers are still modeled with Markov chains, and not yet connected to the Biomodel partial differential equation models.",
    "- Data follows FHIR normalization best practices, and may not reflect raw biomarker data obtained from wearable devices.  One particular example of this is blood pressure, which is reported as two discreet data points in the XML exported from Apple, but which is combined into a single FHIR Observation record with multiple components."
  ],
  "states": {
    "Initial": {
      "type": "Initial",
      "conditional_transition": [
        {
          "transition": "Female",
          "condition": {
            "condition_type": "Gender",
            "gender": "F"
          }
        },
        {
          "transition": "Male",
          "condition": {
            "condition_type": "Gender",
            "gender": "M"
          }
        },
        {
          "transition": "Terminal"
        }
      ]
    },
    "Terminal": {
      "type": "Terminal"
    },
    "Female": {
      "type": "Simple",
      "remarks": [
        "About one-in-five Americans use a smart watch or fitness tracker.  \n https://www.pewresearch.org/short-reads/2020/01/09/about-one-in-five-americans-use-a-smart-watch-or-fitness-tracker/"
      ],
      "distributed_transition": [
        {
          "transition": "Age_20-29",
          "distribution": 0.21
        },
        {
          "transition": "Age_30-39",
          "distribution": 0.21
        },
        {
          "transition": "Age_40-49",
          "distribution": 0.21
        },
        {
          "transition": "Age_50-59",
          "distribution": 0.21
        },
        {
          "transition": "Age_60-74",
          "distribution": 0.21
        }
      ]
    },
    "Male": {
      "type": "Simple",
      "remarks": [
        "About one-in-five Americans use a smart watch or fitness tracker.  \n https://www.pewresearch.org/short-reads/2020/01/09/about-one-in-five-americans-use-a-smart-watch-or-fitness-tracker/"
      ],
      "distributed_transition": [
        {
          "transition": "Age_20-29",
          "distribution": 0.21
        },
        {
          "transition": "Age_30-39",
          "distribution": 0.21
        },
        {
          "transition": "Age_40-49",
          "distribution": 0.21
        },
        {
          "transition": "Age_50-59",
          "distribution": 0.21
        },
        {
          "transition": "Age_60-74",
          "distribution": 0.21
        }
      ]
    },
    "Age_20-29": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 20,
        "high": 29,
        "unit": "years"
      }
    },
    "Age_30-39": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 30,
        "high": 39,
        "unit": "years"
      }
    },
    "Age_40-49": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 40,
        "high": 49,
        "unit": "years"
      }
    },
    "Age_50-59": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 50,
        "high": 59,
        "unit": "years"
      }
    },
    "Age_60-74": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 60,
        "high": 74,
        "unit": "years"
      }
    },


    "Sleep_Apnea": {
      "type": "ConditionOnset",
      "target_encounter": "SleepStudy_Baseline_Encounter",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 415510005,
          "display": "Sedentary lifestyle (finding)"
        }
      ],
      "remarks": [
        "More than 60% of US adults do not engage in recommended amount of physical activity.  25% of adults are not physically active at all.",
        "https://www.cdc.gov/nccdphp/sgr/adults.htm#:~:text=More%20than%2060%20percent%20of,Women%20than%20men."
      ],
      "distributed_transition": [
        {
          "transition": "SleepStudy_Baseline_Encounter",
          "distribution": 0.2
        },
        {
          "transition": "Symptom_Onset_Delay",
          "distribution": 0.79
        },
        {
          "transition": "Terminal",
          "distribution": 0.01
        }
      ]
    },
    "Symptom_Onset_Delay": {
      "type": "Delay",
      "direct_transition": "Insomia_Symptom",
      "range": {
        "low": 1,
        "high": 5,
        "unit": "years"
      }
    },
    "Insomia_Symptom": {
      "type": "Symptom",
      "symptom": "Insomnia",
      "cause": "Sleep_Apnea",
      "direct_transition": "Insomia_Symptom_Ends",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 193462001,
          "display": "Insomnia (disorder)"
        }
      ]
    },
    "Insomia_Symptom_Ends": {
      "type": "Symptom",
      "symptom": "Insomnia",
      "cause": "Sleep_Apnea",
      "direct_transition": "Physical_Activity_Resumes"
    },

    "Physical_Activity_Resumes": {
      "type": "ConditionEnd",
      "condition_onset": "Sleep_Apnea",
      "direct_transition": "Terminal"
    },

    "SleepStudy_Baseline_Encounter": {
      "type": "Encounter",
      "encounter_class": "emergency",
      "reason": "SleepStudy_Baseline",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 60554003,
          "display": "Polysomnography (procedure)"
        }
      ],
      "direct_transition": "Monitor_iWatch"
    },

    "Monitor_iWatch": {
      "type": "Device",
      "code": {
        "system": "SNOMED-CT",
        "code": 13288007,
        "display": "Monitor, device (physical object)"
      },
      "direct_transition": "SleepStudy_Baseline",
      "assign_to_attribute": "snf_iwatch"
    },

    "SleepStudy_Baseline_Encounter_End": {
      "type": "EncounterEnd",
      "direct_transition": "Terminal",
      "discharge_disposition": {
        "system": "NUBC",
        "code": "01",
        "display": "Discharged to home care or self care (routine discharge)"
      }
    },

    "SleepStudy_Baseline": {
      "type": "Observation",
      "category": "exam",
      "unit": "",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": "410189008",
          "display": "Taking patient vitals signs education (procedure)"
        }
      ],
      "direct_transition": "Cycling_Baseline_Distance"
    },




    "Cycling_Baseline_Distance": {
      "type": "Observation",
      "category": "exam",
      "unit": "",
      "codes": [
        {
          "system" : "http://loinc.org",
          "code" : "93818-3",
          "display" : "Cycling distance unspecified time"
        }
      ],
      "direct_transition": "Running_Baseline_StepCount"
    },


    "Running_Baseline_StepCount": {
      "type": "Observation",
      "category": "exam",
      "unit": "",
      "codes": [
        {
          "system" : "http://loinc.org",
          "code" : "55423-8",
          "display" : "Number of steps in unspecified time Pedometer"
        }
      ],
      "direct_transition": "Running_Baseline_Distance"
    },
    "Running_Baseline_Distance": {
      "type": "Observation",
      "category": "exam",
      "unit": "",
      "codes": [
        {
          "system" : "http://loinc.org",
          "code" : "55430-3",
          "display" : "Walking distance unspecified time Pedometer"
        }
      ],
      "direct_transition": "Running_Baseline_DoubleSupport_Percentage"
    },

    "Running_Baseline_DoubleSupport_Percentage": {
      "type": "Observation",
      "category": "exam",
      "unit": "",
      "codes": [
        {
          "system" : "http://loinc.org",
          "code" : "93015-6",
          "display" : "Gait and turn and tandem gait assessment"
        }
      ],
      "direct_transition": "Running_Baseline_WalkingSpeed"
    },
    "Running_Baseline_WalkingSpeed": {
      "type": "Observation",
      "category": "exam",
      "unit": "",
      "codes": [
        {
          "system" : "http://loinc.org",
          "code" : "41957-2",
          "display" : "Walking speed 24 hour mean Calculated"
        }
      ],
      "direct_transition": "FlightsClimbed_Baseline"
    },

    "FlightsClimbed_Baseline": {
      "type": "Observation",
      "category": "exam",
      "unit": "",
      "codes": [
        {
          "system" : "http://loinc.org",
          "code" : "100304-5",
          "display" : "Flights climbed [#] Reporting Period"
        }
      ],
      "direct_transition": "SleepStudy_Baseline"
    },

    "SleepStudy_Baseline": {
      "type": "Procedure",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 60554003,
          "display": "Polysomnography (procedure)"
        }
      ],
      "duration": {
        "low": 5,
        "high": 10,
        "unit": "minutes"
      },
      "direct_transition": "SleepMonitor_Sim"
    },
    "SleepMonitor_Sim": {
      "type": "Physiology",
      "model": "Hong2009_CircadianClock.xml",
      "solver": "runge_kutta",
      "step_size": 0.01,
      "sim_duration": 24,
      "lead_time": 0,
      "inputs": [
        {
          "from_exp": "#{BMI}",
          "to": "kica"
        }
      ],
      "outputs": [
        {
          "from_list": "CPtot",
          "to": "SleepMonitor_result",
          "type": "Attribute"
        }
      ],
      "direct_transition": "SleepMonitor_Data",
      "alt_direct_transition": "Sleep_Imaging"
    },
    "SleepMonitor_Data": {
      "type": "Observation",
      "category": "procedure",
      "unit": "",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 29303009,
          "display": "Electrocardiographic procedure"
        }
      ],
      "sampled_data": {
        "attributes": [
          "SleepMonitor_result"
        ]
      },
      "direct_transition": "SleepMonitor_Chart"
    },
    "SleepMonitor_Chart": {
      "type": "Observation",
      "category": "procedure",
      "unit": "",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 29303009,
          "display": "Electrocardiographic procedure"
        }
      ],
      "attachment": {
        "chart": {
          "type": "line",
          "title": "Electrocardiogram",
          "axis_attribute_x": "time",
          "width": 400,
          "height": 200,
          "series": [
            {
              "attribute": "SleepMonitor_result"
            }
          ]
        }
      },
      "direct_transition": "Clear_SleepMonitor_result"
    },
    "Clear_SleepMonitor_result": {
      "type": "SetAttribute",
      "attribute": "SleepMonitor_result",
      "direct_transition": "SleepAnalysis"
    },
    "SleepAnalysis": {
      "type": "Observation",
      "category": "exam",
      "unit": "",
      "codes": [
        {
          "system" : "http://loinc.org",
          "code" : "93832-4",
          "display" : "Sleep duration."
        }
      ],
      "direct_transition": "SleepStudy_Baseline_Encounter_End"
    }
  },
  "gmf_version": 1
}