{
  "name": "Wearables_O2_Stats",
  "remarks": [
    "Wearable devices are routinely used for fitness activities, compliance monitoring, and remote patient monitoring workflows (such as post-surgical stepdown).  This module simulates the use of an iWatch werable, and adds FHIR Observation resources corresponding to common biomarkers tracked by the iWatch (step count, step distance, flights climbed, standing time, etc).",
    "It uses the Pew Research Center data estimating 20% of the population wears a smartwatch.  With mortality effects and demographic age brackets, this works out to approximately 10% of the Synthea patient's generated having wearables data.",
    "If you wish to include granular ECG data and media files, enable the `physiology.state.enabled` and `physiology.generators.enabled` fields to true in the `synthea.properties` file.",
    "",
    "References",
    "Smartwatch Statistics 2023: How Many People Use Smartwatches?",
    "https://www.demandsage.com/smartwatch-statistics/#:~:text=45%25%20of%20Americans%20regularly%20wear%20smartwatches.",
    "",
    "About one-in-five Americans use a smart watch or fitness tracker",
    "https://www.pewresearch.org/short-reads/2020/01/09/about-one-in-five-americans-use-a-smart-watch-or-fitness-tracker/",
    "", 
    "Known model limitations:",
    "- This module is Apple centric, and may not model biomarkers found in Garmin devices, Fitbits, and other wearables (yet).",
    "- Most biomarkers are still modeled with Markov chains, and not yet connected to the Biomodel partial differential equation models.",
    "- Data follows FHIR normalization best practices, and may not reflect raw biomarker data obtained from wearable devices.  One particular example of this is blood pressure, which is reported as two discreet data points in the XML exported from Apple, but which is combined into a single FHIR Observation record with multiple components."
  ],
  "states": {
    "Initial": {
      "type": "Initial",
      "conditional_transition": [
        {
          "transition": "Female",
          "condition": {
            "condition_type": "Gender",
            "gender": "F"
          }
        },
        {
          "transition": "Male",
          "condition": {
            "condition_type": "Gender",
            "gender": "M"
          }
        },
        {
          "transition": "Terminal"
        }
      ]
    },
    "Terminal": {
      "type": "Terminal"
    },
    "Female": {
      "type": "Simple",
      "remarks": [
        "About one-in-five Americans use a smart watch or fitness tracker.  \n https://www.pewresearch.org/short-reads/2020/01/09/about-one-in-five-americans-use-a-smart-watch-or-fitness-tracker/"
      ],
      "distributed_transition": [
        {
          "transition": "Age_20-29",
          "distribution": 0.21
        },
        {
          "transition": "Age_30-39",
          "distribution": 0.21
        },
        {
          "transition": "Age_40-49",
          "distribution": 0.21
        },
        {
          "transition": "Age_50-59",
          "distribution": 0.21
        },
        {
          "transition": "Age_60-74",
          "distribution": 0.21
        }
      ]
    },
    "Male": {
      "type": "Simple",
      "remarks": [
        "About one-in-five Americans use a smart watch or fitness tracker.  \n https://www.pewresearch.org/short-reads/2020/01/09/about-one-in-five-americans-use-a-smart-watch-or-fitness-tracker/"
      ],
      "distributed_transition": [
        {
          "transition": "Age_20-29",
          "distribution": 0.21
        },
        {
          "transition": "Age_30-39",
          "distribution": 0.21
        },
        {
          "transition": "Age_40-49",
          "distribution": 0.21
        },
        {
          "transition": "Age_50-59",
          "distribution": 0.21
        },
        {
          "transition": "Age_60-74",
          "distribution": 0.21
        }
      ]
    },
    "Age_20-29": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 20,
        "high": 29,
        "unit": "years"
      }
    },
    "Age_30-39": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 30,
        "high": 39,
        "unit": "years"
      }
    },
    "Age_40-49": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 40,
        "high": 49,
        "unit": "years"
      }
    },
    "Age_50-59": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 50,
        "high": 59,
        "unit": "years"
      }
    },
    "Age_60-74": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 60,
        "high": 74,
        "unit": "years"
      }
    },


    "Sleep_Apnea": {
      "type": "ConditionOnset",
      "target_encounter": "Wellness_Baseline_Encounter",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 73430006,
          "display": "Sleep apnea (disorder)"
        }
      ],
      "remarks": [
        "More than 60% of US adults do not engage in recommended amount of physical activity.  25% of adults are not physically active at all.",
        "https://www.cdc.gov/nccdphp/sgr/adults.htm#:~:text=More%20than%2060%20percent%20of,Women%20than%20men."
      ],
      "distributed_transition": [
        {
          "transition": "Wellness_Baseline_Encounter",
          "distribution": 0.2
        },
        {
          "transition": "Symptom_Onset_Delay",
          "distribution": 0.79
        },
        {
          "transition": "Terminal",
          "distribution": 0.01
        }
      ]
    },
    "Symptom_Onset_Delay": {
      "type": "Delay",
      "direct_transition": "Snoring",
      "range": {
        "low": 1,
        "high": 5,
        "unit": "years"
      }
    },
    "Snoring": {
      "type": "Symptom",
      "symptom": "Snoring",
      "cause": "Sleep_Apnea",
      "direct_transition": "Snoring_Ends",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 72863001,
          "display": "Snoring (finding)"
        }
      ]
    },
    "Snoring_Ends": {
      "type": "Symptom",
      "symptom": "Snoring",
      "cause": "Sleep_Apnea",
      "direct_transition": "Sleep_Apnea_Resolved"
    },

    "Sleep_Apnea_Resolved": {
      "type": "ConditionEnd",
      "condition_onset": "Sleep_Apnea",
      "direct_transition": "Terminal"
    },

    "Wellness_Baseline_Encounter": {
      "type": "Encounter",
      "encounter_class": "emergency",
      "reason": "Wellness_Baseline",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 225385005,
          "display": "Behavioral assessment (procedure)"
        }
      ],
      "direct_transition": "Monitor_iWatch"
    },

    "Monitor_iWatch": {
      "type": "Device",
      "code": {
        "system": "SNOMED-CT",
        "code": 13288007,
        "display": "Monitor, device (physical object)"
      },
      "direct_transition": "Monitor_CPAP",
      "assign_to_attribute": "snf_iwatch"
    },
    "Monitor_CPAP": {
      "type": "Device",
      "code": {
        "system": "SNOMED-CT",
        "code": 702172008,
        "display": "Home continuous positive airway pressure unit (physical object)"
      },
      "direct_transition": "Sleep_Study_Baseline",
      "assign_to_attribute": "snf_cpap"
    },


    "Wellness_Baseline_Encounter_End": {
      "type": "EncounterEnd",
      "direct_transition": "Terminal",
      "discharge_disposition": {
        "system": "NUBC",
        "code": "01",
        "display": "Discharged to home care or self care (routine discharge)"
      }
    },

    "Sleep_Study_Baseline": {
      "type": "Observation",
      "category": "exam",
      "unit": "",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": "410189008",
          "display": "Taking patient vitals signs education (procedure)"
        }
      ],
      "direct_transition": "CPAP_Baseline"
    },


    "CPAP_Baseline": {
      "type": "Procedure",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 47545007,
          "display": "Continuous positive airway pressure ventilation treatment (regime/therapy)"
        }
      ],
      "duration": {
        "low": 5,
        "high": 10,
        "unit": "minutes"
      },
      "direct_transition": "CPAP_Sim"
    },
    "CPAP_Sim": {
      "type": "Physiology",
      "model": "Guyton1972_PulmonaryOxygenIntake.xml",
      "solver": "euler",
      "step_size": 0.1,
      "sim_duration": 60,
      "lead_time": 2,
      "inputs": [
        {
          "from_exp": "#{BMI} * 0.497 + 56.15",
          "to": "OVA"
        }
      ],
      "outputs": [
        {
          "from_list": "PO2ART",
          "to": "o2_result",
          "type": "Attribute"
        }
      ],
      "direct_transition": "CPAP_Data",
      "alt_direct_transition": "SleepAnalysis"
    },
    "CPAP_Data": {
      "type": "Observation",
      "category": "procedure",
      "unit": "",
      "codes": [
        {
          "system": "http://loinc.org",
          "code": "2703-7",
          "display": "Oxygen [Partial pressure] in Arterial blood"
        }
      ],
      "sampled_data": {
        "attributes": [
          "o2_result"
        ]
      },
      "direct_transition": "CPAP_Chart"
    },
    "CPAP_Chart": {
      "type": "Observation",
      "category": "procedure",
      "unit": "",
      "codes": [
        {
          "system": "http://loinc.org",
          "code": "2703-7",
          "display": "Oxygen [Partial pressure] in Arterial blood"
        }
      ],
      "attachment": {
        "chart": {
          "type": "line",
          "title": "CPAP O2 Usage",
          "axis_attribute_x": "time",
          "axis_attribute_y": "mmHg",
          "width": 400,
          "height": 200,
          "series": [
            {
              "attribute": "o2_result"
            }
          ]
        }
      },
      "direct_transition": "Clear_CPAP_result"
    },
    "Clear_CPAP_result": {
      "type": "SetAttribute",
      "attribute": "o2_result",
      "direct_transition": "SleepAnalysis"
    },
    "SleepAnalysis": {
      "type": "Observation",
      "category": "exam",
      "unit": "",
      "codes": [
        {
          "system" : "http://loinc.org",
          "code" : "93832-4",
          "display" : "Sleep duration."
        }
      ],
      "direct_transition": "Wellness_Baseline_Encounter_End"
    }
  },
  "gmf_version": 1
}